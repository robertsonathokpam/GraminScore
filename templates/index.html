<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GraminScore AI</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

    <div class="bg-shape shape-1"></div>
    <div class="bg-shape shape-2"></div>

    <div class="main-wrapper">
        <div class="glass-card">
            
            <header>
                <div class="logo-area">
                    <div class="icon-box">
                        <i class="fa-solid fa-house-signal"></i>
                    </div>
                    <div>
                        <h1>GraminScore <span class="highlight">AI</span></h1>
                        <p class="subtitle">Structural Integrity Analysis System</p>
                    </div>
                </div>
            </header>

            {% if error %}
                <div class="notification error">
                    <i class="fa-solid fa-circle-xmark"></i>
                    <span>{{ error }}</span>
                </div>
            {% endif %}

            <form id="analyzeForm" method="POST" action="/analyze" enctype="multipart/form-data">
                <div class="upload-container" id="dropZone">
                    <input type="file" name="images" id="fileInput" multiple required accept="image/*">
                    <div class="upload-visual">
                        <i class="fa-solid fa-cloud-arrow-up"></i>
                    </div>
                    <div class="upload-text">
                        <h3>Upload Site Photos</h3>
                        <p>Drag & drop or click to browse</p>
                    </div>
                    <div id="filePreview" class="file-tags"></div>
                </div>

                <div id="loadingOverlay" class="hidden">
                    <div class="scanner-line"></div>
                    <div class="loader-spinner"></div>
                    <p>Analyzing Structural Patterns...</p>
                </div>

                <button type="submit" class="primary-btn" id="submitBtn">
                    Start Analysis <i class="fa-solid fa-arrow-right"></i>
                </button>
            </form>

            {% if score is defined %}
                <div class="dashboard">
                    
                    <div class="score-card">
                        <div class="circular-chart" style="background: conic-gradient(var(--primary) {{ score }}%, #e2e8f0 0);">
                            <div class="inner-circle">
                                <span class="big-score">{{ score }}</span>
                                <span class="label">/100</span>
                            </div>
                        </div>
                        <div class="score-meta">
                            <h3>Overall Condition</h3>
                            <span class="badge {{ 'good' if score > 75 else 'avg' if score > 45 else 'poor' }}">
                                {{ 'Excellent' if score > 75 else 'Average' if score > 45 else 'Critical' }}
                            </span>
                        </div>
                    </div>

                    <div class="stats-grid">
                        <div class="stat-row">
                            <div class="stat-label"><i class="fa-solid fa-layer-group"></i> Roof</div>
                            <div class="progress-track">
                                <div class="progress-fill" style="width: {{ roof if roof != 'Data Not Available' else 0 }}%;"></div>
                            </div>
                            <div class="stat-value">{{ roof }}</div>
                        </div>
                        
                        <div class="stat-row">
                            <div class="stat-label"><i class="fa-solid fa-border-all"></i> Walls</div>
                            <div class="progress-track">
                                <div class="progress-fill" style="width: {{ walls if walls != 'Data Not Available' else 0 }}%;"></div>
                            </div>
                            <div class="stat-value">{{ walls }}</div>
                        </div>

                        <div class="stat-row">
                            <div class="stat-label"><i class="fa-solid fa-door-open"></i> Door</div>
                            <div class="progress-track">
                                <div class="progress-fill" style="width: {{ door if door != 'Data Not Available' else 0 }}%;"></div>
                            </div>
                            <div class="stat-value">{{ door }}</div>
                        </div>
                    </div>

                    <div class="insight-box">
                        <div class="insight-icon"><i class="fa-solid fa-microchip"></i></div>
                        <p>{{ desc }}</p>
                    </div>

                    <a href="/download" class="download-btn">
                        <i class="fa-solid fa-file-pdf"></i> Download Full Report
                    </a>
                </div>
            {% endif %}

            {% if skipped %}
                <div class="skipped-section">
                    <p><strong>Note:</strong> Some files were ignored:</p>
                    <ul>{% for file in skipped %}<li>{{ file }}</li>{% endfor %}</ul>
                </div>
            {% endif %}

        </div>
    </div>

    <script src="{{ url_for('static', filename='main.js') }}"></script>
</body>
</html>
